# 実験計画手順

## 実験0. 基本的なグラフ構造学習

### 1. グラフ構造の作成

1.  グリッド、リング、六角形グリッドなどのグラフ構造を定義します。
    *   グリッド：正方形または長方形のグリッドを作成し、水平方向と垂直方向の隣接ノード間にエッジを追加します。
    *   リング：ノードを円形に配置し、隣接ノード間にエッジを追加します。
    *   六角形グリッド：六角形を敷き詰めたグリッドを作成し、隣接ノード間にエッジを追加します。
2.  グラフのサイズを決定します（例：4x4グリッド、10ノードリング）。

### 2. ノードの選択

1.  モデルが学習した概念（apple、birdなど）をランダムに選択します。
2.  選択した概念をグラフのノードに割り当てます。
    *   概念は、意味的な相関がないようにランダムに選択します（例：apple、sand、math）。
    *   または、意味的な相関がある概念（例：月曜日、火曜日など）を選択することもできます。

### 3. ランダムウォークの生成

1.  グラフ上でランダムウォークを生成します。
    *   ランダムに開始ノードを選択します。
    *   現在のノードからランダムに隣接ノードを選択し、移動します。
    *   指定されたステップ数だけランダムウォークを繰り返します。
2.  訪問したノードのシーケンスを作成します。

### 4. モデルへの入力

1.  生成されたノードのシーケンスをモデルに入力します。
    *   シーケンスは、モデルが理解できる形式（テキストなど）に変換します。
    *   コンテキストサイズを調整し、モデルに与える情報の量を制御します。

### 5. モデルの評価

1.  モデルの出力確率を評価します。
    *   モデルが予測した次のノードが、グラフ構造に従っているかどうかを判断します。
    *   ルール追跡精度を計算し、モデルがグラフ構造にどれだけ従っているかを定量化します。

### 6. Dirichletエネルギーの計算

1.  モデルの内部表現を使用してDirichletエネルギーを計算します。
    *   モデルの各層におけるトークンの平均アクティベーションを計算します。
    *   Dirichletエネルギーを計算し、グラフ構造との整合性を評価します。
    *   Dirichletエネルギーがコンテキストサイズとともに減少するかどうかを分析します。

### 7. 結果の分析

1.  PCAを使用して、モデルの内部表現を可視化します。
2.  グラフ構造がモデルの内部表現に反映されているかどうかを判断します。
3.  Dirichletエネルギーとルール追跡精度の関係を分析します。
4.  コンテキストサイズがモデルのパフォーマンスに与える影響を評価します。

## 実験1：異なるグラフ構造の影響

1.  グリッド、リング、六角形グリッドなど、異なるグラフ構造を使用して実験を行います。
2.  各グラフ構造におけるモデルのルール追跡精度を比較します。
3.  PCAを使用して、各グラフ構造におけるモデルの内部表現を可視化します。
4.  グラフ構造がモデルの内部表現に与える影響を分析します。
    *   異なるグラフ構造が、モデルの内部表現の形状や配置にどのような影響を与えるかを調べます。
    *   特定のグラフ構造が、モデルにとって学習しやすいかどうかを判断します。

## 実験2：異なるノード選択方法の影響

1.  意味的な相関がない概念（apple、sand、math）と、意味的な相関がある概念（月曜日、火曜日など）を使用して実験を行います。
2.  各ノード選択方法におけるモデルのルール追跡精度を比較します。
3.  PCAを使用して、各ノード選択方法におけるモデルの内部表現を可視化します。
4.  ノードの選択方法がモデルの内部表現に与える影響を分析します。
    *   意味的な相関がある概念を使用した場合、モデルの内部表現がどのように歪むかを調べます。
    *   意味的な相関がない概念を使用した場合、モデルがより純粋なグラフ構造を学習できるかどうかを判断します。

## 実験3：異なるモデルアーキテクチャの影響

1.  Transformer、RNNなど、異なるモデルアーキテクチャを使用して実験を行います。
2.  各モデルアーキテクチャにおけるモデルのルール追跡精度を比較します。
3.  PCAを使用して、各モデルアーキテクチャにおけるモデルの内部表現を可視化します。
4.  モデルアーキテクチャがグラフ構造の学習に与える影響を分析します。
    *   異なるモデルアーキテクチャが、グラフ構造の学習能力にどのような影響を与えるかを調べます。
    *   特定のモデルアーキテクチャが、グラフ構造の学習に適しているかどうかを判断します。
